import 'package:flutter/material.dart';
import 'package:flutter_html/flutter_html.dart';
import 'package:htmltopdfwidgets/htmltopdfwidgets.dart' as html;

class TesterPage extends StatelessWidget {
  final String data = "<html><head><style>.invoice-POS {width: 8.5cm; margin: auto;}\r\n.dashed-line{border - top: 1px dashed #000;margin - top: 5px;} \r\n#top {text - align: center;}   \r\n#top p { margin: 0; }\r\n#bot {text - align: center; }\r\n.table-margin-zero { margin: 0;}     \r\n.table-margin-zero tbody tr {margin: 0;padding: 0;}\r\n.company-logo {float: left;margin-right: 0px;}\r\n</style>\r\n</head>\r\n<body><div class=\"container invoice-POS\"><div>\r\n   <div class=\"company-logo\">\r\n            <img src=\"/\" width=\"80\" height=\"80\" alt=\"\" onerror=\"this.style.display='none'; \" >\r\n        </div>\r\n\r\n<div id=\"top\">\r\n<p style=\"text-align: center;\">Search Technology</p>\r\n<p style=\"text-align: center;\">Dhangadhi</p> <br>\r\n<p style=\"text-align: center;\">VAT No. : 920822695 </p><p style=\"text-align: center;\">\r\nTax Invoice\r\n</p><br><br></div>          <table>                                                         <tbody style=\"font-size: 15px\">                                          <tr><td>Bill No</td><td>:</td><td>SI_222_080/81</td></tr>                                                             <tr><td>Date</td><td>:</td><td>2024-05-24</td></tr>          <tr><td>Miti</td><td>:</td><td></td></tr>         <tr><td>Name</td><td>:</td><td>Cash</td></tr>                       <tr><td>Address</td><td>:</td><td></td></tr>                               <tr><td>PAN No</td><td>:</td><td></td></tr>                      <tr><td>Payment Mode</td><td>: </td><td>Cash</td></tr>                                <tr><td>Remarks</td><td>:</td><td></td></tr>                                                      </tbody>                                                     </table>                                                     </div>                                                                                             </div>                                                                                                                                                                                         <div id=\"bot\" class=\"invoice-POS\">                                                         <div id=\"table\" id=\"productReceit\">                                                             <table class=\"table\">                                                                 <thead>                                                                     <tr> <td class=\"dashed-line\" colspan=\"12\"></td></tr>                                                                     <tr>                                                                         <th class=\"col-1 text-center\">SN</th>                                                                         <th class=\"col-5 text-center\">Particulars</th>                                                                         <th class=\"col-1 text-center\">Qty</th>                                                                         <th class=\"col-2 text-center\">Rate</th>    \r\n<th class=\"col-2 text-center\">Discount</th>                                                                              <th class=\"col-2 text-right\">Amount</th>                                                                     </tr                                                                     <tr> <td class=\"dashed-line\" colspan=\"12\"></td></tr>                                                                 </thead><tbody> <tbody><tr class=\"service\"><td class=\"col-1 text-center\">1</td><td class=\"col-5 text-left\">SaptaKoshi Cement OPC</td><td class=\"col-1 text-right\">1.00</td><td class=\"col-1 text-right\">200.00</td><td class=\"col-2 text-right\">0.00</td><td class=\"col-2 text-right\">200.00</td></tr></tbody >       </tbody></table>                                                              </div></div><div class=\"invoice-POS\"> <div class=\"row\">                                                                     <div class=\"col-4 no-border\"></div>                                                                     <div class=\"col-8 no-border\">                                                                         <table class=\"table table-borderless table-margin-zero\">                                                                             <tbody style=\"font-size: 15px\">                                                                                 <tr> <td class=\"dashed-line\" colspan=\"4\"></td></tr>                                                                                 <tr> <td style=\"width: 30%;\"></td><td style=\"width: 70%;\"><span>------------------------</span></td></tr>                                                                                 <tr> <td style=\"width: 20%;\"></td><td style=\"width: 35%;\">Gross Amount</td><td style=\"width: 5%;\">:</td><td style=\"width: 30%;\">200.00</td></tr>  <tr><td style=\"width: 20%;\"></td><td style=\"width: 35%;\">Discount</td><td style=\"width: 5%;\">:</td><td style=\"width: 30%;\">0.00</td></tr>    <tr><td style=\"width: 20%;\"></td><td style=\"width: 35%;\">Vat Amount:</td><td style=\"width: 5%;\">:</td><td style=\"width: 30%;\">0.00</td></tr>    <tr> <td style=\"width: 20%;\"></td> <td style=\"width: 35%;\">Net Amount</td> <td style=\"width: 5%;\">:</td><td style=\"width: 30%;\">200.00 </td></tr>                                                                                 <tr> <td style=\"width: 30%;\"></td><td style=\"width: 70%;\">-------------------------</td></tr>                                                                                                                                                           </tbody>                                                                         </table>                                                                     </div>                                                                 </div>                                                                         <div class=\"row\">                                                                             <div class=\"col-md-12 text-left\">                                                                                 ------------------------------------------------------ <br>                                                                                     Two Hundred Rupees Only.  <br>                                                                                         ------------------------------------------------------<br>                                                                                     CustomerID: 2 <br>                                                                                     Thank you for visiting us. <br>                                                                                                     ------------------------------------------------------ <br>                                                                                                                                                                    Cashier: 1126 <br>                                                                                                                       </div>                                                                          </div>                                                               </div>                                                                                                                                                   </body>                                                                                 </html> ";

  Future<List<html.Widget>> _convertHtmlToWidgets(String data) async {
    return await html.HTMLToPdf().convert(data);
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Tester Page'),
      ),
      body: FutureBuilder<List<Widget>>(
        future: _convertHtmlToWidgets(data),
        builder: (context, snapshot) {
          if (snapshot.connectionState == ConnectionState.waiting) {
            return Center(child: CircularProgressIndicator());
          } else if (snapshot.hasError) {
            return Center(child: Text('Failed to load widgets'));
          } else if (!snapshot.hasData || snapshot.data!.isEmpty) {
            return Center(child: Text('No widgets available'));
          } else {
            return Column(
              children: snapshot.data!,
            );
          }
        },
      ),
    );
  }
}
